<% if @post.errors.empty? %>
  $("ul#notice").css('opacity', '0');
  $("ul#notice").html(''); // clear earlier flash messages if any.
  $('.posts').prepend("<%= escape_javascript(render @post) %>");
<% else %>
  $("ul#notice").html(''); // clear earlier flash messages if any.
  <% if @post.errors.any? %>
    <% @post.errors.full_messages.each do |msg|  %>
      $("ul#notice").append($("<li />").html("<%= msg.html_safe %>"));
    <% end %>
  <% end %>
  $("ul#notice").css('opacity', '1');
<% end %>

$('.image_upload_preview').removeAttr('src');
$('.add .tooltip').html('Add image');
$('.content_area').val('');